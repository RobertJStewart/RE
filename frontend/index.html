<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RE Market Tool - Static Mode</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .mode-banner {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 30px;
            text-align: center;
            color: white;
        }

        .mode-banner h3 {
            margin-bottom: 10px;
        }

        .mode-banner p {
            opacity: 0.9;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .stat-card p {
            opacity: 0.9;
        }

        .data-sources {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .data-source {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .data-source:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .data-source h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .data-source .meta {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }

        .data-source .description {
            font-size: 0.9rem;
            color: #555;
            margin-top: 10px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .footer {
            text-align: center;
            color: white;
            margin-top: 40px;
            opacity: 0.8;
        }

        .footer a {
            color: white;
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè† RE Market Tool</h1>
            <p>Real Estate Market Analysis & Data Visualization</p>
        </div>

        <div class="mode-banner">
            <h3>üìä Static Mode</h3>
            <p>This is the static version of the RE Market Tool, optimized for GitHub Pages deployment. 
               For full functionality including adding new data sources, use the dynamic version.</p>
        </div>

        <div id="loading" class="loading">
            <h3>üîÑ Loading data...</h3>
            <p>Please wait while we load the market data.</p>
        </div>

        <div id="error" class="error" style="display: none;">
            <h3>‚ùå Error Loading Data</h3>
            <p id="error-message"></p>
        </div>

        <div id="content" style="display: none;">
            <!-- Statistics Overview -->
            <div class="card">
                <h2>üìà Market Overview</h2>
                <div class="stats-grid" id="stats-grid">
                    <!-- Stats will be populated by JavaScript -->
                </div>
            </div>

            <!-- Data Sources -->
            <div class="card">
                <h2>üóÇÔ∏è Available Data Sources</h2>
                <div class="data-sources" id="data-sources">
                    <!-- Data sources will be populated by JavaScript -->
                </div>
            </div>

            <!-- Aggregations -->
            <div class="card">
                <h2>üó∫Ô∏è Geographic Data</h2>
                <div id="aggregations-info">
                    <!-- Aggregation info will be populated by JavaScript -->
                </div>
            </div>

            <!-- Statistics -->
            <div class="card">
                <h2>üìä Statistical Analysis</h2>
                <div id="statistics-info">
                    <!-- Statistics info will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <div class="footer">
            <p>
                <a href="#" onclick="showFullVersion()">üöÄ Try the Full Version</a> | 
                <a href="https://github.com/your-repo" target="_blank">üìÅ View on GitHub</a>
            </p>
            <p>Last updated: <span id="last-updated"></span></p>
        </div>
    </div>

    <script>
        // Global variables
        let dataSources = [];
        let connections = {};
        let aggregations = {};
        let statistics = {};

        // Load all static data
        async function loadStaticData() {
            try {
                console.log('Loading static data...');
                
                // Load data sources
                const dataSourcesResponse = await fetch('static_data/data_sources.json');
                if (!dataSourcesResponse.ok) throw new Error('Failed to load data sources');
                const dataSourcesData = await dataSourcesResponse.json();
                dataSources = dataSourcesData.data_sources || [];
                
                // Load connections
                const connectionsResponse = await fetch('static_data/connections.json');
                if (!connectionsResponse.ok) throw new Error('Failed to load connections');
                const connectionsData = await connectionsResponse.json();
                connections = connectionsData.connections || {};
                
                // Load aggregations metadata
                const aggregationsResponse = await fetch('static_data/aggregations/aggregation_metadata.json');
                if (aggregationsResponse.ok) {
                    aggregations = await aggregationsResponse.json();
                }
                
                // Load statistics metadata
                const statisticsResponse = await fetch('static_data/statistics/metadata.json');
                if (statisticsResponse.ok) {
                    statistics = await statisticsResponse.json();
                }
                
                console.log('Data loaded successfully:', {
                    dataSources: dataSources.length,
                    connections: Object.keys(connections).length,
                    aggregations: Object.keys(aggregations).length,
                    statistics: Object.keys(statistics).length
                });
                
                // Hide loading, show content
                document.getElementById('loading').style.display = 'none';
                document.getElementById('content').style.display = 'block';
                
                // Populate the page
                populateStats();
                populateDataSources();
                populateAggregations();
                populateStatistics();
                updateLastUpdated();
                
            } catch (error) {
                console.error('Error loading static data:', error);
                showError(error.message);
            }
        }

        function showError(message) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('error').style.display = 'block';
            document.getElementById('error-message').textContent = message;
        }

        function populateStats() {
            const statsGrid = document.getElementById('stats-grid');
            
            const stats = [
                {
                    title: 'Total Data Sources',
                    value: dataSources.length,
                    icon: 'üìä'
                },
                {
                    title: 'Active Connections',
                    value: dataSources.filter(ds => ds.status === 'active').length,
                    icon: '‚úÖ'
                },
                {
                    title: 'Geographic Levels',
                    value: new Set(dataSources.map(ds => ds.geography)).size,
                    icon: 'üó∫Ô∏è'
                },
                {
                    title: 'Data Types',
                    value: new Set(dataSources.map(ds => ds.data_type)).size,
                    icon: 'üìà'
                }
            ];
            
            statsGrid.innerHTML = stats.map(stat => `
                <div class="stat-card">
                    <h3>${stat.icon} ${stat.value}</h3>
                    <p>${stat.title}</p>
                </div>
            `).join('');
        }

        function populateDataSources() {
            const dataSourcesContainer = document.getElementById('data-sources');
            
            if (dataSources.length === 0) {
                dataSourcesContainer.innerHTML = '<p>No data sources available.</p>';
                return;
            }
            
            dataSourcesContainer.innerHTML = dataSources.map(ds => `
                <div class="data-source">
                    <h4>${ds.name}</h4>
                    <div class="meta">
                        <strong>Source:</strong> ${ds.data_source} | 
                        <strong>Type:</strong> ${ds.data_type} | 
                        <strong>Geography:</strong> ${ds.geography}
                    </div>
                    <div class="meta">
                        <strong>Update Frequency:</strong> ${ds.update_frequency} | 
                        <strong>Status:</strong> ${ds.status}
                    </div>
                    ${ds.description ? `<div class="description">${ds.description}</div>` : ''}
                </div>
            `).join('');
        }

        function populateAggregations() {
            const aggregationsInfo = document.getElementById('aggregations-info');
            
            if (Object.keys(aggregations).length === 0) {
                aggregationsInfo.innerHTML = '<p>No aggregation data available.</p>';
                return;
            }
            
            aggregationsInfo.innerHTML = `
                <p><strong>Available Geographic Levels:</strong></p>
                <ul>
                    <li>Regions: ${aggregations.regions || 'N/A'}</li>
                    <li>States: ${aggregations.states || 'N/A'}</li>
                    <li>ZIP Codes: ${aggregations.zipcodes || 'N/A'}</li>
                    <li>State Regions: ${aggregations.state_regions || 'N/A'}</li>
                </ul>
                <p><em>Data files are available in the static_data/aggregations/ directory.</em></p>
            `;
        }

        function populateStatistics() {
            const statisticsInfo = document.getElementById('statistics-info');
            
            if (Object.keys(statistics).length === 0) {
                statisticsInfo.innerHTML = '<p>No statistics data available.</p>';
                return;
            }
            
            statisticsInfo.innerHTML = `
                <p><strong>Available Statistics:</strong></p>
                <ul>
                    <li>Basic Statistics: Average, Median, Min, Max, Standard Deviation</li>
                    <li>Percentiles: P10, P25, P75, P90, P95, P99</li>
                    <li>Distribution: Skewness, Kurtosis</li>
                    <li>Volatility: Coefficient of Variation, Range, IQR, MAD, VaR</li>
                    <li>Trends: Linear Trend, Trend Strength, Volatility Trend</li>
                    <li>Momentum: 3-month, 6-month, 12-month momentum</li>
                    <li>Market Health: Positive Change %, Above Median %, Price Efficiency</li>
                </ul>
                <p><em>Statistical data is available in the static_data/statistics/ directory.</em></p>
            `;
        }

        function updateLastUpdated() {
            const lastUpdated = document.getElementById('last-updated');
            lastUpdated.textContent = new Date().toLocaleString();
        }

        function showFullVersion() {
            alert('The full version with dynamic functionality is available when running the Flask server.\n\nTo access the full version:\n1. Run: python frontend/frontend_script.py\n2. Visit: http://localhost:5000\n\nFeatures include:\n- Add new data sources\n- Manage connections\n- Trigger ETL processes\n- Real-time data updates');
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', loadStaticData);
    </script>
</body>
</html>
